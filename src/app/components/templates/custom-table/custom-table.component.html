<!-- SearchBar -->
<div *ngIf = "data != null">

  <div *ngIf = "data.length > 1" class="row">
    <h5>
      <p>Search by</p>
    </h5>
    <select class="col-sm-2" [(ngModel)]="filterKey">
      <option selected="selected" [ngValue]="tableConfig.headers[0].key">
        {{tableConfig.headers[0].label}}
      </option>
      <option class="col-md-2" *ngFor="let column of tableConfig.headers  | slice:1:tableConfig.headers.length" [ngValue]="column.key">
        {{column.label}}
      </option>
    </select>

    <input class="col-md-1" *ngIf = "data.length > 1"  type="search" [(ngModel)]="filter" class="form-control w-25 p-2" placeholder="Search">
  </div>


    <app-custom-button *ngIf = "data.length > 1 && filter!==undefined && filter !==''" [buttonConfig]="cancelButtonConfig" (click)="filter=undefined"></app-custom-button>


</div>

<div style="float: right">
<!--Add Button-->
<ng-container *ngFor ="let action of tableConfig.actions">
  <app-custom-button *ngIf="!action.rowAction" [buttonConfig]="{text:action.text, icon:action.icon, customCssClass:'btn btn-primary btn-sm'}" (click)="actionMethod(null,action)"></app-custom-button>
</ng-container>
</div>

<!-- Main Table -->
<div *ngIf = "data == null">
  The table is Empty
</div>

<div *ngIf = "data != null ">
<table class="table table-striped table-light table-bordered">
  <thead class="table-dark">
   <tr>
    <th scope="col" *ngFor="let header of tableConfig.headers" (click)="sort(header.key)" scope = "col">
      {{header.label}}
      <i *ngIf="orderType === 'asc' && data.length>1">
        <fa-icon [icon]="faArrowUp "></fa-icon>
      </i>
      <i *ngIf="orderType === 'desc' && data.length>1">
        <fa-icon [icon]="faArrowDown"></fa-icon>
      </i>
    </th>
    <th scope="col" *ngIf = "tableConfig.actions && tableConfig.actions.length>0">
      opzioni
    </th>
   </tr>
  </thead>

  <tbody>
  <tr *ngFor="let obj of data | searchingPipe : filter : filterKey | paginationPipe :currentPage :pageItems | sortingPipe : key : orderType; let objIndex=index">
    <td *ngFor="let header of tableConfig.headers">
      {{getValue(obj,header.key)}}
    </td>
    <td >
      <span *ngFor =" let action of tableConfig.actions">

        <app-custom-button *ngIf =" action.rowAction && action.dynamicAction === undefined" [buttonConfig] ="{text:action.text, icon: action.icon, customCssClass:action.customCssClass}" (click) ="actionMethod(obj,action)"></app-custom-button>

        <app-custom-button *ngIf =" action.rowAction && action.dynamicAction === true" [buttonConfig] ="{text:action.text, icon: action.icon, customCssClass:action.customCssClass}" (click) ="actionMethod(obj,action)"></app-custom-button>

      </span>

    </td>
  </tr>
  </tbody>

</table>


<!-- Previous Page -->
<app-custom-button *ngIf = "data.length > 1 && totalPages.length>1 && currentPage!=1" style="padding-right: 10px" [buttonConfig]="previousButtonConfig" (click)="movePage(false)"></app-custom-button>

<!-- Range of Pages -->

<app-custom-button *ngIf = "data.length >1 && totalPages.length>1" style="padding-right: 10px" [buttonConfig]="{text:'1', customCssClass:'btn btn-dark btn-sm'}"  (click)="setPage(1)" [enabled]="1 !== currentPage" ></app-custom-button>
<ng-container *ngIf="currentPage>3">...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</ng-container>

<ng-container  *ngFor="let page of pages" >

  <app-custom-button *ngIf = "data.length >1 && totalPages.length>1" style="padding-right: 10px" [buttonConfig]="{text:page.toString(), customCssClass:'btn btn-dark btn-sm'}"  (click)="setPage(page)" [enabled]="page !== currentPage" ></app-custom-button>

</ng-container>

<ng-container *ngIf="currentPage<totalPages.length-2">...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</ng-container>

<app-custom-button *ngIf = "data.length >1 && totalPages.length>1" style="padding-right: 10px" [buttonConfig]="{text:totalPages.length.toString(), customCssClass:'btn btn-dark btn-sm'}"  (click)="setPage(totalPages.length)" [enabled]="totalPages.length !== currentPage" ></app-custom-button>


<!-- Next Page -->
<app-custom-button *ngIf = "data.length > 1 && totalPages.length>1 && currentPage!=totalPages.length" [buttonConfig]="nextButtonConfig" (click)="movePage(true)"></app-custom-button>

</div>


